<ui:composition
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="./../commons/template.xhtml">

	<f:metadata>
		<f:event
			type="preRenderView"
			listener="#{usuarioSessionMB.validarSesion}" />
	</f:metadata>
	
	<ui:define name="content">
		<p:panel	id="IDPanelGeneral"
					header=""
					style="#{msj['p.panelGrande']} margin-top: 10pt;">
			<h:form id="IDFrmPrincipal">
				<p:panelGrid 	id="IDPnlGridTab1"
			                    style="margin-top: 10pt; margin:0 auto;">
					<p:row>
						<p:column>
							<h:outputText value="Desde:" />
						</p:column>
						<p:column style="#{msj['p.column_width_mediano_inputText']}">
					    	<p:calendar	id="filterTripDateFrom" 
			                        	mode="popup" 
			                        	showOn="button" 
			                        	value="#{reportesBean.filterTripDateFrom}"
			                        	navigator="true" 
			                        	effect="fadeIn" 
			                        	pattern="dd/MM/yyyy" 
			                        	size="8">
			                    <p:ajax event="dateSelect" listener="#{reportesBean.filtrarPorFechaSeleccionada}" />
					        </p:calendar>
						</p:column>
						<p:column/>
					</p:row>
					<p:row>
						<p:column>
							<h:outputText value="Hasta:" />
						</p:column>
						<p:column style="#{msj['p.column_width_mediano_inputText']}">
					    	<p:calendar	id="filterTripDateTo" 
			                        	mode="popup" 
			                        	showOn="button"
			                        	value="#{reportesBean.filterTripDateTo}" 
			                        	navigator="true" 
			                        	effect="fadeIn" 
			                        	pattern="dd/MM/yyyy" 
			                        	size="8">
			                    <p:ajax event="dateSelect" listener="#{reportesBean.filtrarPorFechaSeleccionada}" />
					        </p:calendar>
						</p:column>
						<p:column/>
					</p:row>
					<p:row>
						<p:column>
					    	<p:commandButton 	id="IDCmdBtnLimpiar"
					    						value="Limpiar"
					    					 	actionListener="#{reportesBean.limpiarFechas}"/>
						</p:column>
						<p:column>
										
						</p:column>
						<p:column>
					    	<p:commandButton 	value="Export as Excel" 
					    						ajax="false">
								<p:dataExporter type="xls" 
												target="IDDataTblReporte" 
												fileName="Reporte"/>
							</p:commandButton>
						</p:column>
					</p:row>
				</p:panelGrid>			
				
				
				<p:dataTable 	id="IDDataTblReporte" 
								value="#{reportesBean.depuraciones}"
								var="VDataTblReporte"
								selectionMode="single"
								selection="#{reportesBean.logDepuracion}"
								rowKey="#{VDataTblReporte.id}"		
								emptyMessage="#{msj['p.dataTable_emptyMessage']}"
								paginator="true" 
								rows="25"	
								editable="false">
								
					<p:ajax event="rowSelect" listener="#{reportesBean.onRowSelect}"/>
					<p:column 	style="#{msj['p.column_width_diminuto']}" 
								headerText="#{msj['reporte.pais']}"
								filterStyle="#{msj['p.column_filter']}"
								filterBy="#{VDataTblReporte.metodo.agregador.pais.nombre}"
								filterMatchMode="contains">
						<h:outputText style="font-size:10px;" value="#{VDataTblReporte.metodo.agregador.pais.nombre}" />
					</p:column>
					<p:column 	style="#{msj['p.column_width_diminuto']}"
								headerText="#{msj['reporte.agregador']}"
								filterStyle="#{msj['p.column_filter']}"
								filterBy="#{VDataTblReporte.metodo.agregador.nombre_agregador}"
								filterMatchMode="contains">
						<h:outputText style="font-size:10px;" value="#{VDataTblReporte.metodo.agregador.nombre_agregador}" />
					</p:column>
					<p:column 	style="#{msj['p.column_width_diminuto']}"
								headerText="#{msj['reporte.suscriptor']}"
								filterStyle="#{msj['p.column_filter']}"
								filterBy="#{VDataTblReporte.numero}"
								filterMatchMode="contains">
						<h:outputText style="font-size:10px;" value="#{VDataTblReporte.numero}" />
					</p:column>
					<p:column 	style="#{msj['p.column_width_diminuto']}"
								headerText="#{msj['reporte.metodo']}"
								filterStyle="#{msj['p.column_filter']}"
								filterBy="#{reportesBean.metodoLabel(VDataTblReporte.metodo.metodo)}"
								filterMatchMode="contains">
						<h:outputText style="font-size:10px;" value="#{reportesBean.metodoLabel(VDataTblReporte.metodo.metodo)}" />
					</p:column>
					<p:column 	style="#{msj['p.column_width_diminuto']}"
								headerText="#{msj['reporte.empleado']}" 
								filterStyle="#{msj['p.column_filter']}"
								filterBy="#{VDataTblReporte.usuarioSistema.usuario}"
								filterMatchMode="contains">
						<h:outputText style="font-size:10px;" value="#{VDataTblReporte.usuarioSistema.usuario}" />
					</p:column>
					<p:column 	style="#{msj['p.column_width_diminuto']}"
								headerText="#{msj['reporte.fecha']}" >
						<h:outputText style="font-size:10px;" value="#{VDataTblReporte.fechaTransaccion}" >
							 <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss"/>
						</h:outputText>
					</p:column>
					<p:column 	style="#{msj['p.column_width_diminuto']}"
								headerText="#{msj['reporte.estado']}"
								filterStyle="#{msj['p.column_filter']}"
								filterBy="#{VDataTblReporte.estadoTransaccion}"
								filterMatchMode="contains">
						<h:outputText style="font-size:10px;" value="#{VDataTblReporte.estadoTransaccion}" />
					</p:column>
					<p:column 	style="#{msj['p.column_width_diminuto']}"
								headerText="#{msj['reporte.tipo']}"
								filterStyle="#{msj['p.column_filter']}"
								filterBy="#{VDataTblReporte.tipoTransaccion}"
								filterMatchMode="contains">
						<h:outputText style="font-size:10px;" value="#{VDataTblReporte.tipoTransaccion}" />
					</p:column>
					
				</p:dataTable>	
			</h:form>
		</p:panel>
		
		<!-- dialogo de Abono a cuenta -->
	<p:dialog
		id="IDDialogreporte" header="DescripciÃ³n de Reporte"
		widgetVar="WVDialogReporte" resizable="false"
		showEffect="fade" modal="true" width="600" closable="true">
		<p:panel	id="IDPanelReporte"
					header="#{msj['depuracionUnitaria.header']}"
					style="#{msj['p.panelMediano']} margin-top: 10pt;">
			<h:form 	id="IDFrmDialogReporte">
				<p:panelGrid 	id="IDPnlGridDialogReporte">
					<p:row>
						<p:column>
							<h:outputText value="#{msj['reporte.agregador']}" />
						</p:column>
						<p:column>
							<h:outputText value="#{reportesBean.logDepuracion.metodo.agregador.nombre_agregador}" />
						</p:column>
					</p:row>
					<p:row>
						<p:column>
							<h:outputText value="#{msj['reporte.suscriptor']}" />
						</p:column>
						<p:column>
							<h:outputText value="#{reportesBean.logDepuracion.numero}" />
						</p:column>
					</p:row>
					<p:row>
						<p:column>
							<h:outputText value="Descripcion" />
						</p:column>
						<p:column>
							<h:outputText value="#{reportesBean.logDepuracion.descripcionEstado}" />
						</p:column>						
					</p:row>
				</p:panelGrid>
			</h:form>		
		</p:panel>
	</p:dialog>	
		
	</ui:define>
	
</ui:composition>